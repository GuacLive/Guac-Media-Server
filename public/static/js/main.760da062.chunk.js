(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{269:function(e,t,a){e.exports=a(553)},274:function(e,t,a){},549:function(e,t,a){},553:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(9),s=a.n(r),o=(a(274),a(554),a(61)),l=(a(170),a(12)),c=a(53),d=a(54),p=a(57),u=a(55),m=a(58),h=(a(278),a(71)),f=a(102),y=a(69),x=a(34),g=(a(171),a(62)),v=(a(173),a(27)),b=(a(165),a(49)),E=a(103);function O(e){if(0===e)return"0 Byte";e=Number(e);var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}function k(e){if(0===e)return 0;var t=8*Number(e);return Math.round(t/Math.pow(1024,2),2)}function I(e){e=Number(e);var t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),i=Math.floor(e%60);return(t>0?t+(1===t?" day, ":" days, "):"")+(a>0?a+(1===a?" hour, ":" hours, "):"")+(n>0?n+(1===n?" minute, ":" minutes, "):"")+(i>0?i+(1===i?" second":" seconds"):"")}function j(e){e=Number(e);var t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60);return(t>0?t+"d,":"")+(a>0?a+"h,":"")+(n>0?n+"m,":"")+(Math.floor(e%60)+"s")}var w=a(101),M=a.n(w),A=a(21),S=a.n(A);a(353),a(373),a(379),a(390);function B(e){return{title:{text:e},tooltip:{trigger:"axis"},grid:{left:"2%",right:"4%",bottom:"2%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{type:"value",max:100}],series:[{name:e,type:"line",areaStyle:{normal:{}},data:[]}]}}var C=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).count=0,a.lastInBytes=0,a.lastOtBytes=0,a.state={cpuOption:B("CPU Usage"),memOption:B("Memory Usage"),conOption:{title:{text:"Connections"},tooltip:{trigger:"axis"},legend:{data:["Rtmp","Http","WebSocket"]},grid:{left:"2%",right:"4%",bottom:"2%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{type:"value"}],series:[{name:"Rtmp",type:"line",data:[]},{name:"Http",type:"line",data:[]},{name:"WebSocket",type:"line",data:[]}]},netOption:{title:{text:"Network Bandwidth"},tooltip:{trigger:"axis",axisPointer:{animation:!1}},axisPointer:{link:{xAxisIndex:"all"}},legend:{data:["Input","Output"]},grid:[{left:50,right:50,height:"35%"},{left:50,right:50,top:"55%",height:"35%"}],xAxis:[{type:"category",boundaryGap:!1,axisLine:{onZero:!0},data:[],show:!1},{gridIndex:1,type:"category",boundaryGap:!1,axisLine:{onZero:!0},data:[],position:"bottom"}],yAxis:[{name:"Mbps",type:"value"},{gridIndex:1,type:"value",inverse:!0}],series:[{name:"Input",type:"line",data:[]},{name:"Output",type:"line",xAxisIndex:1,yAxisIndex:1,data:[]}]}},a.fetch=function(){fetch("/api/server",{credentials:"include"}).then(function(e){return e.json()}).then(function(e){a.lastInBytes=a.lastInBytes||e.net.inbytes,a.lastOtBytes=a.lastOtBytes||e.net.outbytes;var t=new Date,n=t.toLocaleTimeString().replace(/^\D*/,""),i=Object(E.a)({},a.state.cpuOption),r=Object(E.a)({},a.state.memOption),s=Object(E.a)({},a.state.conOption),o=Object(E.a)({},a.state.netOption);a.count++>30&&(i.xAxis[0].data.shift(),i.series[0].data.shift(),r.xAxis[0].data.shift(),r.series[0].data.shift(),s.xAxis[0].data.shift(),s.series[0].data.shift(),s.series[1].data.shift(),s.series[2].data.shift(),o.xAxis[0].data.shift(),o.xAxis[1].data.shift(),o.series[0].data.shift(),o.series[1].data.shift()),i.uptime=t,i.xAxis[0].data.push(n),i.series[0].data.push(e.cpu.load),r.uptime=t,r.xAxis[0].data.push(n),r.series[0].data.push((100-100*e.mem.free/e.mem.totle).toFixed(2)),s.uptime=t,s.title.text="Connections "+(e.clients.rtmp+e.clients.http+e.clients.ws),s.xAxis[0].data.push(n),s.series[0].data.push(e.clients.rtmp),s.series[1].data.push(e.clients.http),s.series[2].data.push(e.clients.ws),o.uptime=t,o.xAxis[0].data.push(n),o.xAxis[1].data.push(n),o.series[0].data.push(k((e.net.inbytes-a.lastInBytes)/2)),o.series[1].data.push(k((e.net.outbytes-a.lastOtBytes)/2)),a.lastInBytes=e.net.inbytes,a.lastOtBytes=e.net.outbytes,a.setState({cpuOption:i,memOption:r,conOption:s,netOption:o})}).catch(function(e){})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.fetch(),this.timer=setInterval(this.fetch,2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){return i.a.createElement(g.a,{style:{margin:"0 -12px"}},i.a.createElement(v.a,{span:12,style:{padding:"0 12px"}},i.a.createElement(b.a,null,i.a.createElement(M.a,{echarts:S.a,ref:"echarts_react",option:this.state.conOption,style:{height:"348px",width:"100%"}}))),i.a.createElement(v.a,{span:12,style:{padding:"0 12px"}},i.a.createElement(b.a,null,i.a.createElement(M.a,{echarts:S.a,ref:"echarts_react",option:this.state.netOption,style:{height:"348px",width:"100%"}}))),i.a.createElement(v.a,{span:12,style:{padding:"0 12px",marginTop:"16px"}},i.a.createElement(b.a,null,i.a.createElement(M.a,{echarts:S.a,ref:"echarts_react",option:this.state.cpuOption,style:{height:"300px",width:"100%"}}))),i.a.createElement(v.a,{span:12,style:{padding:"0 12px",marginTop:"16px"}},i.a.createElement(b.a,null,i.a.createElement(M.a,{echarts:S.a,ref:"echarts_react",option:this.state.memOption,style:{height:"300px",width:"100%"}}))))}}]),t}(n.Component),N=(a(256),a(129)),D=[{dataIndex:"name",key:"name",width:200},{dataIndex:"value",key:"value"}],T=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={data:[],loading:!1},a.fetch=function(){a.setState({loading:!0}),fetch("/api/server",{credentials:"include"}).then(function(e){return e.json()}).then(function(e){var t={key:0,name:"OS",value:e.os.arch+"_"+e.os.platform+"_"+e.os.release},n={key:1,name:"CPU",value:e.cpu.num+" x "+e.cpu.model},i={key:2,name:"Memory",value:O(e.mem.totle)},r={key:3,name:"Node.js",value:e.nodejs.version},s={key:4,name:"Uptime",value:I(e.nodejs.uptime)},o={key:5,name:"Version",value:e.version};a.setState({loading:!1,data:[t,n,i,r,s,o]})}).catch(function(e){a.setState({loading:!1})})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"render",value:function(){return i.a.createElement(b.a,{title:i.a.createElement(n.Fragment,null,i.a.createElement(l.a,{type:"hdd"}),i.a.createElement("span",{style:{paddingLeft:"12px",fontSize:"16px"}},"Server Info"))},i.a.createElement(N.a,{dataSource:this.state.data,columns:D,loading:this.state.loading,pagination:!1,showHeader:!1}))}}]),t}(n.Component),P=[{title:"App",dataIndex:"app",key:"app"},{title:"Name",dataIndex:"name",key:"name"},{title:"ID",dataIndex:"id",key:"id"},{title:"IP",dataIndex:"ip",key:"ip"},{title:"Audio",children:[{title:"codec",dataIndex:"ac",key:"ac"},{title:"freq",dataIndex:"freq",key:"freq"},{title:"chan",dataIndex:"chan",key:"chan"}]},{title:"Video",children:[{title:"codec",dataIndex:"vc",key:"vc"},{title:"size",dataIndex:"size",key:"size"},{title:"fps",dataIndex:"fps",key:"fps"}]},{title:"Time",dataIndex:"time",key:"time"},{title:"Clients",dataIndex:"clients",key:"clients"}],_=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={streamsData:[],loading:!1},a.fetch=function(){a.setState({loading:!0}),fetch("/api/streams",{credentials:"include"}).then(function(e){return e.json()}).then(function(e){var t=[],n=0;for(var i in e)for(var r in e[i]){var s=e[i][r].publisher,o=e[i][r].subscribers;if(s){var l=(new Date).getTime()/1e3,c=new Date(s.connectCreated).getTime()/1e3,d={key:n++,app:i,name:r,id:s.clientId,ip:s.ip,ac:s.audio?s.audio.codec+" "+s.audio.profile:"",freq:s.audio?s.audio.samplerate:"",chan:s.audio?s.audio.channels:"",vc:s.video?s.video.codec+" "+s.video.profile:"",size:s.video?s.video.width+"x"+s.video.height:"",fps:s.video?Math.floor(s.video.fps):"",time:j(l-c),clients:o.length};t.push(d)}}a.setState({loading:!1,streamsData:t})}).catch(function(e){a.setState({loading:!1})})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"render",value:function(){return i.a.createElement(b.a,null,i.a.createElement(N.a,{dataSource:this.state.streamsData,columns:P,loading:this.state.loading,bordered:!0,small:!0,pagination:!1}))}}]),t}(n.Component),H=(a(549),h.a.Header),L=h.a.Sider,U=h.a.Content,z=h.a.Footer,G=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).fullTitle="NodeMediaServer",a.shortTitle="NMS",a.state={collapsed:!1,title:a.fullTitle,pathname:"/"},a.toggle=function(){a.setState({collapsed:!a.state.collapsed,title:a.state.collapsed?a.fullTitle:a.shortTitle})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return i.a.createElement(f.a,null,i.a.createElement(h.a,{style:{minHeight:"100vh"}},i.a.createElement(L,{width:256,trigger:null,collapsible:!0,collapsed:this.state.collapsed},i.a.createElement("div",{className:"logo"},i.a.createElement("h1",null,this.state.title)),i.a.createElement(o.b,{theme:"dark",mode:"inline",defaultSelectedKeys:[Object(x.a)().location.pathname]},i.a.createElement(o.b.Item,{key:"/admin/"},i.a.createElement(f.b,{to:"/admin/"},i.a.createElement(l.a,{type:"dashboard"}),i.a.createElement("span",null,"Dashboard"))),i.a.createElement(o.b.Item,{key:"/admin/streams"},i.a.createElement(f.b,{to:"/admin/streams"},i.a.createElement(l.a,{type:"video-camera"}),i.a.createElement("span",null,"Streams"))),i.a.createElement(o.b.Item,{key:"/admin/profile"},i.a.createElement(f.b,{to:"/admin/profile"},i.a.createElement(l.a,{type:"profile"}),i.a.createElement("span",null,"Profile"))))),i.a.createElement(h.a,null,i.a.createElement(H,{style:{background:"#fff",padding:0}},i.a.createElement(l.a,{className:"trigger",type:this.state.collapsed?"menu-unfold":"menu-fold",onClick:this.toggle})),i.a.createElement(U,{style:{margin:"24px 16px",minHeight:280}},i.a.createElement(y.a,{exact:!0,path:"/admin",component:C}),i.a.createElement(y.a,{path:"/admin/streams",component:_}),i.a.createElement(y.a,{path:"/admin/profile",component:T})),i.a.createElement(z,{style:{textAlign:"center"}},"Node-Media-Server \xa92019 Created by ",i.a.createElement("a",{href:"http://nodemedia.cn",rel:"noopener noreferrer",target:"_blank"},"NodeMedia"),"."))))}}]),t}(n.Component);s.a.render(i.a.createElement(G,null),document.getElementById("root"))}},[[269,1,2]]]);
//# sourceMappingURL=main.760da062.chunk.js.map